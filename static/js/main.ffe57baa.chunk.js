(this.webpackJsonplab2=this.webpackJsonplab2||[]).push([[0],{22:function(e,t,n){e.exports=n(39)},27:function(e,t,n){},32:function(e,t,n){},33:function(e,t,n){},34:function(e,t,n){},35:function(e,t,n){},36:function(e,t,n){},37:function(e,t,n){},38:function(e,t,n){},39:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(10),c=n.n(o),i=(n(27),n(2)),s=n(3),u=n(5),l=n(4),p=n(6),f=n(12),d=n(8);n(32);function m(e){return a.a.createElement("form",{class:"add-city",onSubmit:function(t){return e.onSubmit(t)}},a.a.createElement("input",{class:"input",type:"text",name:"cityName",placeholder:"City name",required:!0}),a.a.createElement("input",{class:"button",type:"submit",value:"Add to city"}))}var y=n(21),E="https://api.openweathermap.org/data/2.5/weather",h="&appid=7825ce4ffa896c5019e53087c858568a&units=metric&lang=en",O="https://openweathermap.org/img/wn/";function v(e){var t=e.coord,n=Object(y.a)(e.weather,1)[0],r=n.icon,a=n.description,o=e.main,c=o.temp,i=o.pressure,s=o.humidity,u=e.wind.speed;return{cityName:e.name,temperature:c,pressure:i,humidity:s,windSpeed:u,icon:r,description:a,coords:t}}n(33);function b(e){return a.a.createElement("div",{className:"param"},a.a.createElement("div",{className:"name"},e.name),a.a.createElement("div",{className:"value"},e.value))}n(34);function C(){return a.a.createElement("div",{className:"loader"},a.a.createElement("p",null,"Forecast is loading..."))}n(35);var g=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.onFetch();console.log("tyt"),console.log(e)}},{key:"render",value:function(){return this.props.forecast?this.renderWeather():this.renderLoader()}},{key:"renderLoader",value:function(){return a.a.createElement(C,null)}},{key:"renderWeather",value:function(){var e,t=this.props,n=t.forecast,r=n.cityName,o=n.temperature,c=n.icon,i=n.windSpeed,s=n.description,u=n.pressure,l=n.humidity,p=n.coords,f=(p=void 0===p?{}:p).lat,d=p.lon,m=t.onDelete;return a.a.createElement("div",{className:"city"},a.a.createElement("div",{className:"header"},a.a.createElement("div",{className:"city-name"},r),a.a.createElement("div",{className:"temperature"},o," \u2103"),a.a.createElement("img",{src:(e=c,"".concat(O).concat(e,".png")),alt:"Weather icon"})),a.a.createElement(b,{name:"Wind",value:"".concat(i," m/s")}),a.a.createElement(b,{name:"Cloudness",value:s}),a.a.createElement(b,{name:"Pressure",value:"".concat(u," hPa")}),a.a.createElement(b,{name:"Humidity",value:"".concat(l,"%")}),a.a.createElement(b,{name:"Coords",value:"".concat(f,", ").concat(d)}),m&&a.a.createElement("button",{className:"button",onClick:m},"delete"))}}]),t}(a.a.Component),j={"ADD_\u0421ITY":"ADD_\u0421ITY","DELETE_\u0421ITY":"DELETE_\u0421ITY",FETCH_CITY_SUCCESS:"FETCH_CITY_SUCCESS",FETCH_CITY_ERROR:"FETCH_CITY_ERROR"};function T(e){var t="".concat(E,"?q=").concat(e).concat(h);return function(n){fetch(t).then((function(t){t.json().then((function(r){console.log(t,r),t.ok?n(function(e,t){return{type:j.FETCH_CITY_SUCCESS,payload:{apiResponse:e,cityName:t}}}(r,e)):n(_(r.message,e))}))}),(function(t){return n(_(t,e))}))}}function _(e,t){return{type:j.FETCH_CITY_ERROR,payload:{error:e,cityName:t}}}n(36);var S=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return a.a.createElement("div",{className:"cities"},a.a.createElement("h1",null,"\u0421ities"),a.a.createElement(m,{onSubmit:function(t){return e.handleCityForm(t)}}),this.props.error&&a.a.createElement("div",{className:"error"},"Error: ",this.props.error),a.a.createElement("div",{className:"forecasts"},Object(f.a)(this.props.cities.entries()).map((function(t){return console.log(t[0]),a.a.createElement(g,{key:t[0],onFetch:function(){return e.props.fetchWeatherByCityName(t[0])},onDelete:function(){return e.props.delete\u0421ity(t[0])},forecast:t[1]})}))))}},{key:"handleCityForm",value:function(e){e.preventDefault();var t=e.currentTarget.elements.cityName.value;this.props.add\u0421ity(t)}}]),t}(a.a.Component);var w=Object(d.b)((function(e){return{cities:e.cities.cities,error:e.cities.error}}),(function(e){return{"add\u0421ity":function(t){e(function(e){return{type:j.ADD_\u0421ITY,payload:e}}(t))},"delete\u0421ity":function(t){e(function(e){return{type:j.DELETE_\u0421ITY,payload:e}}(t))},fetchWeatherByCityName:function(t){e(T(t))}}}))(S),N={SET_GEOLOCATION:"SET_GEOLOCATION",FETCH_GEO_SUCCESS:"FETCH_GEO_SUCCESS",FETCH_GEO_ERROR:"FETCH_GEO_ERROR"};function k(e){var t="".concat(E,"?lat=").concat(e.lat,"&lon=").concat(e.lon).concat(h);return function(e){fetch(t).then((function(t){t.json().then((function(n){var r;console.log(t,n),t.ok?e((r=n,{type:N.FETCH_GEO_SUCCESS,payload:r})):e(R(n.message))}))}),(function(t){return e(R(t))}))}}function R(e){return{type:N.FETCH_GEO_ERROR,payload:e}}n(37);var D=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.getGeolocation()}},{key:"render",value:function(){var e=this;return a.a.createElement("div",{className:"geolocation"},a.a.createElement("h1",{className:"header"},"Refresh geolocation"),a.a.createElement("button",{className:"button",onClick:function(){return e.handleClick()}},"Get geolocation"),this.props.error?a.a.createElement("div",{className:"error"},"Error: ",this.props.error):this.props.coords&&a.a.createElement(g,{onFetch:function(){return e.props.fetchWeatherByCoords(e.props.coords)},forecast:this.props.forecast}))}},{key:"handleClick",value:function(){this.getGeolocation()}},{key:"getGeolocation",value:function(){var e=this;navigator.geolocation?navigator.geolocation.getCurrentPosition((function(t){var n={lat:t.coords.latitude,lon:t.coords.longitude};e.props.setGeolocation(n),e.props.fetchWeatherByCoords(e.props.coords)}),(function(){e.props.setGeolocation({lat:46.47,lon:41.53}),e.props.fetchWeatherByCoords(e.props.coords)})):this.props.fetchGeoError("your browser does not support geolocation")}}]),t}(a.a.Component);var I=Object(d.b)((function(e){return{coords:e.geo.coords,forecast:e.geo.forecast,error:e.geo.error}}),(function(e){return{setGeolocation:function(t){e(function(e){return{type:N.SET_GEOLOCATION,payload:e}}(t))},fetchWeatherByCoords:function(t){e(k(t))},fetchGeoError:function(t){e(R(t))}}}))(D),F=(n(38),function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return a.a.createElement("div",null,a.a.createElement(I,null),a.a.createElement(w,null))}}]),t}(a.a.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var G=n(9),P=n(19),H=n.n(P),Y=n(20),W=n(11),A="cities";function L(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var B={cities:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:A,t=JSON.parse(localStorage.getItem(e)),n=[];return null!==t&&Array.isArray(t)&&(n=t),new Map(n.map((function(e){return[e,void 0]})))}()};function U(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var J=Object(G.d)(Object(G.c)({cities:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:B,t=arguments.length>1?arguments[1]:void 0;switch(e=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?L(n,!0).forEach((function(t){Object(W.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):L(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e,{error:!1,cities:new Map(e.cities)}),t.type){case j.ADD_\u0421ITY:e.cities.has(t.payload)||e.cities.set(t.payload);break;case j.DELETE_\u0421ITY:e.cities.delete(t.payload);break;case j.FETCH_CITY_SUCCESS:console.log(t.payload.apiResponse);var n=v(t.payload.apiResponse);e.cities.delete(t.payload.cityName),e.cities.set(n.cityName,n);break;case j.FETCH_CITY_ERROR:e.error=t.payload.error,e.cities.delete(t.payload.cityName)}return e},geo:function(e,t){switch(e=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?U(n,!0).forEach((function(t){Object(W.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):U(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e,{error:!1}),t.type){case N.SET_GEOLOCATION:e.coords=t.payload;break;case N.FETCH_GEO_SUCCESS:e.forecast=v(t.payload);break;case N.FETCH_GEO_ERROR:e.error=t.payload}return e}}),Object(G.a)(H.a,Y.a));J.subscribe((function(){localStorage.setItem(A,JSON.stringify(Object(f.a)(J.getState().cities.cities.keys())))}));var M=J;c.a.render(a.a.createElement(d.a,{store:M},a.a.createElement(F,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[22,1,2]]]);
//# sourceMappingURL=main.ffe57baa.chunk.js.map